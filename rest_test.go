// rest_test
package main

import (
	"encoding/json"
	"strings"
	"testing"

	"github.com/stvp/assert"
)

/*
http://103.25.23.99/VDN/statistic.serverSummary.action
{"data":["2017.07.04 14:45:41.639|1|5|103.25.23.74|10000|0|1|1","2017.07.04 14:45:41.639|63|5|175.102.132.80|10000|0|1|1","2017.07.04 14:45:41.639|68|5|121.46.2.17|10000|0|1|1","2017.07.04 14:45:41.639|10000|4|103.25.23.75|11015|10000|1|1","2017.07.04 14:45:41.639|10001|4|175.102.132.81|11015|10001|1|1","2017.07.04 14:45:41.639|10002|4|121.46.2.18|10015|10002|1|1","2017.07.04 14:45:41.639|20001|1|103.25.23.75|10021|0|1|1","2017.07.04 14:45:41.639|20005|1|175.102.132.81|10021|0|1|1","2017.07.04 14:45:41.639|20152|1|121.46.2.18|10021|0|1|1","2017.07.04 14:45:41.639|40000|3|103.25.23.75|10012|0|1|1","2017.07.04 14:45:41.639|40001|3|175.102.132.81|10012|0|1|1","2017.07.04 14:45:41.639|40002|3|121.46.2.18|10012|0|1|1","2017.07.04 14:45:41.639|50000|6|103.25.23.75|10032|0|1|1","2017.07.04 14:45:41.639|50001|6|175.102.132.81|10032|0|1|1","2017.07.04 14:45:41.639|50002|6|121.46.2.18|10032|0|1|1","2017.07.04 14:45:41.639|30000|2|103.25.23.75|10017|0|1|1","2017.07.04 14:45:41.639|30001|2|175.102.132.81|10017|0|1|1","2017.07.04 14:45:41.639|30002|2|121.46.2.18|10017|0|1|1","2017.07.04 14:45:41.639|1|8|210.51.168.108|9000|0|1|1","2017.07.04 14:45:41.639|2|8|114.112.74.12|9000|0|1|1","2017.07.04 14:45:41.639|3|8|175.102.21.33|9000|0|1|1","2017.07.04 14:45:41.639|4|8|175.102.8.227|9000|0|1|1","2017.07.04 14:45:41.639|5|8|122.13.78.226|9000|0|1|1","2017.07.04 14:45:41.639|6|8|125.88.254.159|9000|0|1|1","2017.07.04 14:45:41.639|7|8|125.211.202.28|9000|0|1|1","2017.07.04 14:45:41.639|8|8|222.171.242.142|9000|0|1|1","2017.07.04 14:45:41.639|9|8|123.138.91.24|9000|0|1|1","2017.07.04 14:45:41.639|10|8|124.116.176.115|9000|0|1|1","2017.07.04 14:45:41.639|11|8|221.7.112.74|9000|0|1|1","2017.07.04 14:45:41.639|13|8|220.249.119.217|9000|0|1|1","2017.07.04 14:45:41.639|14|8|61.183.245.140|9000|0|1|1","2017.07.04 14:45:41.639|19|8|103.25.23.121|9000|0|1|1","2017.07.04 14:45:41.639|20|8|103.25.23.122|9000|0|1|1","2017.07.04 14:45:41.639|21|8|223.111.205.86|9000|0|1|1","2017.07.04 14:45:41.639|23|8|223.111.205.90|9000|0|1|1"],"desc":["时间","节点ID","服务器类型","IP","port","所属hostID,只有host子服务有效，其他服务为空","是否发布:1表示发布，0表示未发布","是否健康:1表示健康，0表示不健康"],"result":0}

http://103.25.23.99/VDN/statistic.userStatistic.action
{"data":["2017.07.04 14:45:41.639|4364|1206|327|281|0|[463,115,50,2726,0,899,0,111,0,0]"],"desc":["时间","在线用户数","匿名用户数","可激活用户数","最近三分钟登录用户数","最近三分钟登出用户数","分类终端在线用户数"],"result":0}

http://103.25.23.99/VDN/statistic.callStatistic.action
{"data":["2017.07.04 14:45:41.639|50|9|41|50|4|90|2"],"desc":["时间","当前通话并发总数","当前视频通话总数","当前音频通话总数","最近3分钟通话量","最近3分钟未接通数","最近3分钟正常挂断数","最近3分钟异常挂断数"],"result":0}

http://103.25.23.99/VDN/statistic.host.action
{"data":["2017.07.04 14:45:40.899|10000|103.25.23.75|11015|1|10000|1474|39|373|0|101|5|93|0|27|11|16|2040|1252|0|2726|924|0|0|0|[158,38,13,950,0,281,0,34,0,0]","2017.07.04 14:45:40.899|10001|175.102.132.81|11015|1|10000|1473|43|438|0|228|7|85|0|35|16|19|2460|1306|171|2623|1004|0|0|0|[169,39,23,892,0,314,0,36,0,0]","2017.07.04 14:45:40.899|10002|121.46.2.18|10015|1|10000|1417|45|395|0|113|7|103|0|25|9|16|1790|2211|130|3234|1143|0|0|0|[136,38,14,884,0,304,0,41,0,0]"],"desc":["时间","Host节点ID","Host IP","Host Port","Host是否健康","额定用户数","在线用户数","坐席在线个数","匿名在线用户数","工作线程未处理任务数","最近3分钟登录次数","最近3分钟登出次数","最近3分钟登录用户数","最近3分钟登出用户数","最近3分钟查询被叫次数","最近3分钟查询被叫本地命中次数","最近3分钟查询被叫DHT查询次数","最近3分钟转发消息次数","最近3分钟转发消息CAHCE命中次数","最近3分钟转发消息DHT查询次数","最近3分钟转发消息本地命中次数","最近3分钟发送坐席状态消息次数","最近3分钟发送用户排队位置消息次数","最近3分钟向APNS通道推送次数","最近3分钟向静默通道推送次数","在线用户设备分布列表"],"result":0}

http://103.25.23.99/VDN/statistic.relay.action
{"data":["2017.07.04 14:45:41.639|1|210.51.168.108|9000|31|52|1495|8027|23692|0|30|30|109|111","2017.07.04 14:45:41.639|2|114.112.74.12|9000|38|55|2016|8358|121410|0|31|34|1233|1245","2017.07.04 14:45:41.639|3|175.102.21.33|9000|41|58|2199|8758|130133|0|58|53|428|429","2017.07.04 14:45:41.639|4|175.102.8.227|9000|57|91|2729|7870|159410|0|75|65|748|750","2017.07.04 14:45:41.639|5|122.13.78.226|9000|36|92|3279|5910|135061|0|70|69|475|475","2017.07.04 14:45:41.639|6|125.88.254.159|9000|2|3|17|541|0|0|0|0|2|3","2017.07.04 14:45:41.639|7|125.211.202.28|9000|2|11|121|269|4637|0|0|0|21|21","2017.07.04 14:45:41.639|8|222.171.242.142|9000|17|0|1|3614|0|0|0|0|4|5","2017.07.04 14:45:41.639|9|123.138.91.24|9000|40|104|3384|8655|58639|0|86|86|446|452","2017.07.04 14:45:41.639|10|124.116.176.115|9000|12|21|31|2864|25781|0|1|0|178|178","2017.07.04 14:45:41.639|11|221.7.112.74|9000|0|14|21|0|0|0|0|0|0|0","2017.07.04 14:45:41.639|13|220.249.119.217|9000|63|123|4433|8777|183507|0|98|101|1236|1234","2017.07.04 14:45:41.639|14|61.183.245.140|9000|91|95|3652|21080|190239|0|77|91|382|383","2017.07.04 14:45:41.639|19|103.25.23.121|9000|4|9|545|263|199871|0|1|1|1867|2320","2017.07.04 14:45:41.639|20|103.25.23.122|9000|3|8|543|424|59792|0|0|0|57|1124","2017.07.04 14:45:41.639|21|223.111.205.86|9000|0|0|0|0|0|0|0|0|0|0","2017.07.04 14:45:41.639|23|223.111.205.90|9000|0|0|60|73|36950|0|0|2|0|0"],"desc":["时间","relay节点id","relay IP","relay Port","并发通话数","接入|落地用户数","最近3分钟短链保活消息数","最近3分钟转发建路包数","最近3分钟转发媒体包数","最近3分钟无效消息数据","最近3分钟通话建立次数","最近3分钟通话结束次数","最近3分钟平均媒体转发上行流量","最近3分钟平均媒体转发下行流量"],"result":0}

http://103.25.23.99/VDN/statistic.bootstrap.action
{"data":["2017.07.04 14:45:40.836|1|103.25.23.74|10000|97|3|3|2","2017.07.04 14:45:40.836|63|175.102.132.80|10000|60|3|3|2","2017.07.04 14:45:40.836|68|121.46.2.17|10000|55|3|3|2"],"desc":["时间","Bootstrap节点ID","Bootstrap IP","Bootstrap Port","3分钟查询次数","当前健康HOST数","当前HOST总数","路由表长度"],"result":0}

http://103.25.23.99/VDN/statistic.DHT.action
{"data":["2017.07.04 14:45:40.973|20001|0|103.25.23.75|10021|1|1|2|4364|325|6421|14|[{\"host_id\":10000,\"host_pid\":14105,\"host_ip\":\"103.25.23.75\",\"host_port\":11015},{\"host_id\":10001,\"host_pid\":31177,\"host_ip\":\"175.102.132.81\",\"host_port\":11015},{\"host_id\":10002,\"host_pid\":11766,\"host_ip\":\"121.46.2.18\",\"host_port\":10015}]|118|5022|115,3,0,0,0,0","2017.07.04 14:45:40.973|20005|0|175.102.132.81|10021|1|1|2|4364|45|4227|14|[{\"host_id\":10000,\"host_pid\":14105,\"host_ip\":\"103.25.23.75\",\"host_port\":11015},{\"host_id\":10001,\"host_pid\":31177,\"host_ip\":\"175.102.132.81\",\"host_port\":11015},{\"host_id\":10002,\"host_pid\":11766,\"host_ip\":\"121.46.2.18\",\"host_port\":10015}]|315|4873|296,17,0,0,0,0","2017.07.04 14:45:40.973|20152|0|121.46.2.18|10021|1|1|2|4364|327|6446|14|[{\"host_id\":10000,\"host_pid\":14105,\"host_ip\":\"103.25.23.75\",\"host_port\":11015},{\"host_id\":10001,\"host_pid\":31177,\"host_ip\":\"175.102.132.81\",\"host_port\":11015},{\"host_id\":10002,\"host_pid\":11766,\"host_ip\":\"121.46.2.18\",\"host_port\":10015}]|268|4764|261,7,0,0,0,0"],"desc":["时间","DHT节点id","所属Host节点ID","DHT的KAD IP\t","DHt的KAD Port","DHT连接状态","DHT是否健康","路由表个数","在线信息用户数","ANPS离线信息用户数","有静默通道用户数","Connect应用总数","Host列表","最近3分钟内GetValue次数","最近3分钟内SetValue次数","GetValue响应速度列表"],"result":0}

http://103.25.23.99/VDN/statistic.SPS.action
{"data":["2017.07.04 14:45:41.099|50000|0|103.25.23.75|10032|1387|4053|2184|1869|0|0","2017.07.04 14:45:41.099|50001|0|175.102.132.81|10032|1370|5494|2393|3101|0|0","2017.07.04 14:45:41.099|50002|0|121.46.2.18|10032|1331|2925|853|2072|0|0"],"desc":["时间","SPS节点id","所属Host节点ID","SPS IP","SPS Port","通道[信令双通道+静默通道]连接数","最近3分钟发送消息总数","最近3分钟双通道发送给Host消息数","最近3分钟双通道给客发送客户端消息数","最近3分钟静默通道推送次数","最近3分钟静默通道推送成功次数"],"result":0}

http://103.25.23.99/VDN/statistic.ANPS.action
{"data":["2017.07.04 14:45:41.264|30000|0|103.25.23.75|10017|1|0|0|0|0","2017.07.04 14:45:41.264|30001|0|175.102.132.81|10017|0|0|0|0|0","2017.07.04 14:45:41.264|30002|0|121.46.2.18|10017|1|0|0|0|0"],"desc":["时间","PS节点id","所属Host节点ID","PS IP","PS Port","与APNS连接成功通道数","待推送的任务数","最近3分钟推送总数","最近3分钟推送成功次数","最近3分钟推送失败次数"],"result":0}

http://103.25.23.99/VDN/statistic.CM.action
{"data":["2017.07.04 14:45:41.035|40000|0|103.25.23.75|10012|16|0|0|19|1|0|0|0","2017.07.04 14:45:41.035|40001|0|175.102.132.81|10012|19|0|0|34|0|2|1|0","2017.07.04 14:45:41.035|40002|0|121.46.2.18|10012|15|0|0|37|1|0|1|0"],"desc":["时间","CallMgr节点ID","所属Host节点ID","CallMgr IP","CallMgr port","当前通话数","最近3分钟视频通数","最近3分钟音频话数","最近3分钟正常挂断通话数","最近3分钟异常挂断通话数","最近3分钟系统原因未接通数","最近3分钟人为原因未接通数","最近3分钟被叫不在线未接通数"],"result":0}

*/
func TestAction(t *testing.T) {
	type ActData struct {
		Data   []string `json:"data"`
		Desc   []string `json:"desc"`
		Result int      `json:"result"`
	}
	actions := []struct {
		action   string
		response string
	}{
		{action: "statistic.serverSummary.action", response: `{"data":["2017.07.04 14:45:41.639|1|5|103.25.23.74|10000|0|1|1","2017.07.04 14:45:41.639|63|5|175.102.132.80|10000|0|1|1","2017.07.04 14:45:41.639|68|5|121.46.2.17|10000|0|1|1","2017.07.04 14:45:41.639|10000|4|103.25.23.75|11015|10000|1|1","2017.07.04 14:45:41.639|10001|4|175.102.132.81|11015|10001|1|1","2017.07.04 14:45:41.639|10002|4|121.46.2.18|10015|10002|1|1","2017.07.04 14:45:41.639|20001|1|103.25.23.75|10021|0|1|1","2017.07.04 14:45:41.639|20005|1|175.102.132.81|10021|0|1|1","2017.07.04 14:45:41.639|20152|1|121.46.2.18|10021|0|1|1","2017.07.04 14:45:41.639|40000|3|103.25.23.75|10012|0|1|1","2017.07.04 14:45:41.639|40001|3|175.102.132.81|10012|0|1|1","2017.07.04 14:45:41.639|40002|3|121.46.2.18|10012|0|1|1","2017.07.04 14:45:41.639|50000|6|103.25.23.75|10032|0|1|1","2017.07.04 14:45:41.639|50001|6|175.102.132.81|10032|0|1|1","2017.07.04 14:45:41.639|50002|6|121.46.2.18|10032|0|1|1","2017.07.04 14:45:41.639|30000|2|103.25.23.75|10017|0|1|1","2017.07.04 14:45:41.639|30001|2|175.102.132.81|10017|0|1|1","2017.07.04 14:45:41.639|30002|2|121.46.2.18|10017|0|1|1","2017.07.04 14:45:41.639|1|8|210.51.168.108|9000|0|1|1","2017.07.04 14:45:41.639|2|8|114.112.74.12|9000|0|1|1","2017.07.04 14:45:41.639|3|8|175.102.21.33|9000|0|1|1","2017.07.04 14:45:41.639|4|8|175.102.8.227|9000|0|1|1","2017.07.04 14:45:41.639|5|8|122.13.78.226|9000|0|1|1","2017.07.04 14:45:41.639|6|8|125.88.254.159|9000|0|1|1","2017.07.04 14:45:41.639|7|8|125.211.202.28|9000|0|1|1","2017.07.04 14:45:41.639|8|8|222.171.242.142|9000|0|1|1","2017.07.04 14:45:41.639|9|8|123.138.91.24|9000|0|1|1","2017.07.04 14:45:41.639|10|8|124.116.176.115|9000|0|1|1","2017.07.04 14:45:41.639|11|8|221.7.112.74|9000|0|1|1","2017.07.04 14:45:41.639|13|8|220.249.119.217|9000|0|1|1","2017.07.04 14:45:41.639|14|8|61.183.245.140|9000|0|1|1","2017.07.04 14:45:41.639|19|8|103.25.23.121|9000|0|1|1","2017.07.04 14:45:41.639|20|8|103.25.23.122|9000|0|1|1","2017.07.04 14:45:41.639|21|8|223.111.205.86|9000|0|1|1","2017.07.04 14:45:41.639|23|8|223.111.205.90|9000|0|1|1"],"desc":["时间","节点ID","服务器类型","IP","port","所属hostID,只有host子服务有效，其他服务为空","是否发布:1表示发布，0表示未发布","是否健康:1表示健康，0表示不健康"],"result":0}`},
		{action: "statistic.userStatistic.action", response: `{"data":["2017.07.04 14:45:41.639|4364|1206|327|281|0|[463,115,50,2726,0,899,0,111,0,0]"],"desc":["时间","在线用户数","匿名用户数","可激活用户数","最近三分钟登录用户数","最近三分钟登出用户数","分类终端在线用户数"],"result":0}`},
		{action: "statistic.callStatistic.action", response: `{"data":["2017.07.04 14:45:41.639|50|9|41|50|4|90|2"],"desc":["时间","当前通话并发总数","当前视频通话总数","当前音频通话总数","最近3分钟通话量","最近3分钟未接通数","最近3分钟正常挂断数","最近3分钟异常挂断数"],"result":0}`},
		{action: "statistic.host.action", response: `{"data":["2017.07.04 14:45:40.899|10000|103.25.23.75|11015|1|10000|1474|39|373|0|101|5|93|0|27|11|16|2040|1252|0|2726|924|0|0|0|[158,38,13,950,0,281,0,34,0,0]","2017.07.04 14:45:40.899|10001|175.102.132.81|11015|1|10000|1473|43|438|0|228|7|85|0|35|16|19|2460|1306|171|2623|1004|0|0|0|[169,39,23,892,0,314,0,36,0,0]","2017.07.04 14:45:40.899|10002|121.46.2.18|10015|1|10000|1417|45|395|0|113|7|103|0|25|9|16|1790|2211|130|3234|1143|0|0|0|[136,38,14,884,0,304,0,41,0,0]"],"desc":["时间","Host节点ID","Host IP","Host Port","Host是否健康","额定用户数","在线用户数","坐席在线个数","匿名在线用户数","工作线程未处理任务数","最近3分钟登录次数","最近3分钟登出次数","最近3分钟登录用户数","最近3分钟登出用户数","最近3分钟查询被叫次数","最近3分钟查询被叫本地命中次数","最近3分钟查询被叫DHT查询次数","最近3分钟转发消息次数","最近3分钟转发消息CAHCE命中次数","最近3分钟转发消息DHT查询次数","最近3分钟转发消息本地命中次数","最近3分钟发送坐席状态消息次数","最近3分钟发送用户排队位置消息次数","最近3分钟向APNS通道推送次数","最近3分钟向静默通道推送次数","在线用户设备分布列表"],"result":0}`},
		{action: "statistic.relay.action", response: `{"data":["2017.07.04 14:45:41.639|1|210.51.168.108|9000|31|52|1495|8027|23692|0|30|30|109|111","2017.07.04 14:45:41.639|2|114.112.74.12|9000|38|55|2016|8358|121410|0|31|34|1233|1245","2017.07.04 14:45:41.639|3|175.102.21.33|9000|41|58|2199|8758|130133|0|58|53|428|429","2017.07.04 14:45:41.639|4|175.102.8.227|9000|57|91|2729|7870|159410|0|75|65|748|750","2017.07.04 14:45:41.639|5|122.13.78.226|9000|36|92|3279|5910|135061|0|70|69|475|475","2017.07.04 14:45:41.639|6|125.88.254.159|9000|2|3|17|541|0|0|0|0|2|3","2017.07.04 14:45:41.639|7|125.211.202.28|9000|2|11|121|269|4637|0|0|0|21|21","2017.07.04 14:45:41.639|8|222.171.242.142|9000|17|0|1|3614|0|0|0|0|4|5","2017.07.04 14:45:41.639|9|123.138.91.24|9000|40|104|3384|8655|58639|0|86|86|446|452","2017.07.04 14:45:41.639|10|124.116.176.115|9000|12|21|31|2864|25781|0|1|0|178|178","2017.07.04 14:45:41.639|11|221.7.112.74|9000|0|14|21|0|0|0|0|0|0|0","2017.07.04 14:45:41.639|13|220.249.119.217|9000|63|123|4433|8777|183507|0|98|101|1236|1234","2017.07.04 14:45:41.639|14|61.183.245.140|9000|91|95|3652|21080|190239|0|77|91|382|383","2017.07.04 14:45:41.639|19|103.25.23.121|9000|4|9|545|263|199871|0|1|1|1867|2320","2017.07.04 14:45:41.639|20|103.25.23.122|9000|3|8|543|424|59792|0|0|0|57|1124","2017.07.04 14:45:41.639|21|223.111.205.86|9000|0|0|0|0|0|0|0|0|0|0","2017.07.04 14:45:41.639|23|223.111.205.90|9000|0|0|60|73|36950|0|0|2|0|0"],"desc":["时间","relay节点id","relay IP","relay Port","并发通话数","接入|落地用户数","最近3分钟短链保活消息数","最近3分钟转发建路包数","最近3分钟转发媒体包数","最近3分钟无效消息数据","最近3分钟通话建立次数","最近3分钟通话结束次数","最近3分钟平均媒体转发上行流量","最近3分钟平均媒体转发下行流量"],"result":0}`},
		{action: "statistic.bootstrap.action", response: `{"data":["2017.07.04 14:45:40.836|1|103.25.23.74|10000|97|3|3|2","2017.07.04 14:45:40.836|63|175.102.132.80|10000|60|3|3|2","2017.07.04 14:45:40.836|68|121.46.2.17|10000|55|3|3|2"],"desc":["时间","Bootstrap节点ID","Bootstrap IP","Bootstrap Port","3分钟查询次数","当前健康HOST数","当前HOST总数","路由表长度"],"result":0}`},
		{action: "statistic.DHT.action", response: `{"data":["2017.07.04 14:45:40.973|20001|0|103.25.23.75|10021|1|1|2|4364|325|6421|14|[{\"host_id\":10000,\"host_pid\":14105,\"host_ip\":\"103.25.23.75\",\"host_port\":11015},{\"host_id\":10001,\"host_pid\":31177,\"host_ip\":\"175.102.132.81\",\"host_port\":11015},{\"host_id\":10002,\"host_pid\":11766,\"host_ip\":\"121.46.2.18\",\"host_port\":10015}]|118|5022|115,3,0,0,0,0","2017.07.04 14:45:40.973|20005|0|175.102.132.81|10021|1|1|2|4364|45|4227|14|[{\"host_id\":10000,\"host_pid\":14105,\"host_ip\":\"103.25.23.75\",\"host_port\":11015},{\"host_id\":10001,\"host_pid\":31177,\"host_ip\":\"175.102.132.81\",\"host_port\":11015},{\"host_id\":10002,\"host_pid\":11766,\"host_ip\":\"121.46.2.18\",\"host_port\":10015}]|315|4873|296,17,0,0,0,0","2017.07.04 14:45:40.973|20152|0|121.46.2.18|10021|1|1|2|4364|327|6446|14|[{\"host_id\":10000,\"host_pid\":14105,\"host_ip\":\"103.25.23.75\",\"host_port\":11015},{\"host_id\":10001,\"host_pid\":31177,\"host_ip\":\"175.102.132.81\",\"host_port\":11015},{\"host_id\":10002,\"host_pid\":11766,\"host_ip\":\"121.46.2.18\",\"host_port\":10015}]|268|4764|261,7,0,0,0,0"],"desc":["时间","DHT节点id","所属Host节点ID","DHT的KAD IP\t","DHt的KAD Port","DHT连接状态","DHT是否健康","路由表个数","在线信息用户数","ANPS离线信息用户数","有静默通道用户数","Connect应用总数","Host列表","最近3分钟内GetValue次数","最近3分钟内SetValue次数","GetValue响应速度列表"],"result":0}`},
		{action: "statistic.SPS.action", response: `{"data":["2017.07.04 14:45:41.099|50000|0|103.25.23.75|10032|1387|4053|2184|1869|0|0","2017.07.04 14:45:41.099|50001|0|175.102.132.81|10032|1370|5494|2393|3101|0|0","2017.07.04 14:45:41.099|50002|0|121.46.2.18|10032|1331|2925|853|2072|0|0"],"desc":["时间","SPS节点id","所属Host节点ID","SPS IP","SPS Port","通道[信令双通道+静默通道]连接数","最近3分钟发送消息总数","最近3分钟双通道发送给Host消息数","最近3分钟双通道给客发送客户端消息数","最近3分钟静默通道推送次数","最近3分钟静默通道推送成功次数"],"result":0}`},
		{action: "statistic.ANPS.action", response: `{"data":["2017.07.04 14:45:41.264|30000|0|103.25.23.75|10017|1|0|0|0|0","2017.07.04 14:45:41.264|30001|0|175.102.132.81|10017|0|0|0|0|0","2017.07.04 14:45:41.264|30002|0|121.46.2.18|10017|1|0|0|0|0"],"desc":["时间","PS节点id","所属Host节点ID","PS IP","PS Port","与APNS连接成功通道数","待推送的任务数","最近3分钟推送总数","最近3分钟推送成功次数","最近3分钟推送失败次数"],"result":0}`},
		{action: "statistic.CM.action", response: `{"data":["2017.07.04 14:45:41.035|40000|0|103.25.23.75|10012|16|0|0|19|1|0|0|0","2017.07.04 14:45:41.035|40001|0|175.102.132.81|10012|19|0|0|34|0|2|1|0","2017.07.04 14:45:41.035|40002|0|121.46.2.18|10012|15|0|0|37|1|0|1|0"],"desc":["时间","CallMgr节点ID","所属Host节点ID","CallMgr IP","CallMgr port","当前通话数","最近3分钟视频通数","最近3分钟音频话数","最近3分钟正常挂断通话数","最近3分钟异常挂断通话数","最近3分钟系统原因未接通数","最近3分钟人为原因未接通数","最近3分钟被叫不在线未接通数"],"result":0}`},
	}

	for _, act := range actions {
		serverSummary := []byte(act.response)
		serverSummaryS := ActData{}
		err := json.Unmarshal(serverSummary, &serverSummaryS)
		if err != nil {
			t.Fatal("TestAction:", err)
		}
		t.Log(act.action, ":", serverSummaryS.Result)
		t.Log(serverSummaryS.Desc)
		for _, d := range serverSummaryS.Data {
			assert.Equal(t, len(serverSummaryS.Desc), len(strings.Split(d, "|")), "")
			t.Log(d)
		}
		t.Log("--------------------------------------------------------------")
	}
}
